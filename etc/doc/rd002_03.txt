--------------------------------------------------------------------------------
  rd002_03.txt - RadiOS documentation file.

                 Description: RadiOS Module Linker user's manual.
                 Version: 0.01
                 Document type: plain text, CR/LF
                 Language: Russian, CP866
                 Copyright: (c) 1999 Yuri Zaporogets.
--------------------------------------------------------------------------------

                  Описание компоновщика модулей rmlink.

 1. Введение.

 Компоновщик модулей rmlink предназначен для формирования модулей операционной
 системы RadiOS из обьектных файлов, соответствующих стандарту Microsoft OMF
 и библиотечных файлов, соответствующих стандарту Borland Library Format.
 Компоновщик написан на ANSI C и может быть скомпилирован как для системы MSDOS
 с использованием компилятора Borland Turbo C++ 3.0, так и для системы RadiOS.


 2. Режимы работы компоновщика

 Компоновщик может быть запущен как с указанием всех параметров в командной
 строке или в специальном файле (пакетный режим), так и с использованием ввода
 параметров с терминала (диалоговый режим).


 3. Пакетный режим.

 Командная строка при запуске компоновщика в пакетном режиме имеет следующий
 вид:

  rmlink [-option -option ...] objects ,targetfilename ,map ,libraries ,def

 , где option - необязательные флаги,
       objects - имена объектных файлов, перечисленные через пробел,
       targetfilename - имя файла целевого модуля,
       map - имя файла карты,
       libraries - имена библиотечных файлов, перечисленные через пробел,
       def - имя файла определений модуля.

 Вместо указания всех параметров непосредтвенно в командной строке они могут
 быть сгруппированы в отдельный текстовый файл. Синтаксис вызова компоновщика
 в этом случае имеет вид:

  rmlink @file_with_parameters

 , где file_with_parameters - имя файла с параметрами. Параметры в файле могут
 разделяться не только пробелами, а и символами табуляции и перевода строки.


 4. Диалоговый режим.

 Для работы компоновщика в диалоговом режиме в командной строке указываются
 только необязательные флаги (опции). Все остальные параметры будут запрошены
 у оператора с терминала.


 5. Опции.

 В командной строке компоновщика могут указываться следующие опции:

  -map           - сгенерировать расширенный файл карты;
  -notitle       - запретить вывод заставки при работе компоновщика;
  -case          - производить компоновку с различием регистра;
  -j <path_list> - указать пути поиска обьектных файлов (пути разделяются
                   точкой с запятой);
  -L <path_list> - указать пути поиска библиотек;
  -? или -help - выдать краткую справку.


 6. Файл определений модуля.

 При компоновке любого модуля обязательно требуется указывать компоновщику файл
 определений модуля. В этом файле перечисляются такие данные, как имя модуля,
 его тип, экспорт и импорт модуля и др.

 Файл определений представляет собой текстовый файл, в котором указываются
 директивы компоновщику. Порядок размещения директив не имеет значения; регистр
 при их обработке не учитывается. Могут также указываться комментарии, они
 игнорируются компоновщиком. Начало комментария может находиться в любом месте
 строки, оно начинается последовательностью символов '//'. Конец комментария - 
 символ перевода строки.

 Директивы файла определений модуля:

  ModuleName <имя_модуля> - установка имени модуля;

  ModuleType {exe,lib,data} - установка типа модуля (соответственно исполняемый,
                              библиотечный и модуль данных);

  Export - начало блока определений экспортируемых имен;

  ExportAll - экспортировать все имена, объявленные в объектных файлах как
              public или global;

  Import - начало блока определений импортируемых имен;

  ImportAll $<имя_модуля> - импортировать все имена, объявленные в объектных
                            файлах как extern, из одного модуля;

  Stack <stack_size> - установить для исполняемого модуля размер стека равным
                       <stack_size> двойных слов.

 Блок определения экспортируемых имен начинается после директивы Export и
 продолжается до обнаружения новой директивы компоновщика. Разделителем имен в
 блоке могут служить пробелы, знаки табуляции и перевода строки. Если
 встречается имя, начинающееся с точки, то оно считается началом определения
 имен нового субмодуля (см. rd001). Имя, состоящее из одной точки, указывает
 компоновщику, что последующие имена экспортируются непосредственно из модуля.

 Блок определения импортируемых имен начинается после директивы Import и
 продолжается до обнаружения новой директивы компоновщика. Разделители имен
 те же, что и в блоке экспорта. Имя, начинающееся с символа '$' указывает
 имя модуля (возможно вместе с субмодулем), из которого будут импортироваться
 последующие имена.

 Примеры файлов определений модуля:

 Пример 1.

  // Модуль библиотеки языка Pascal, версия 0.1

  ModuleName PasLib
  ModuleType lib

  ExportAll                 // экспорт всех public-имен

  Import

  $KERNEL                   // импорт из модуля Kernel
  GetDate
  GetTime

  $KERNEL.FileSystem        // импорт из субмодуля FileSystem модуля Kernel
  Open
  Close

  $KERNEL.MM                // импорт из субмодуля MM этого же модуля
  Alloc
  Free
  //-------------------------------------------

 Пример 2.

  ModuleName SomeProgram
  ModuleType exe
  Stack 4096                // 4096 двойных слов для стека

  Export

  BubbleSort                // эти имена экспортируются непосредственно
  QuickSort                 // из модуля

  .Search
  BinarySearch              // а эти имена - из субмодуля Search
  HashSearch

  ImportAll $PasLib         // импортировать все имена из модуля PasLib


--------------------------------------------------------------------------------

    RadiOS Programmer's Manual                                   08 Jul 1999

--------------------------------------------------------------------------------
