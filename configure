#! /bin/sh

# Default paths
RADIOSPATH=`pwd`
INCLPATH=$RADIOSPATH/include
OBJPATH=$RADIOSPATH/build/obj
LIBPATH=$RADIOSPATH/build/obj/lib
INSTALLPATH=/boot/RadiOS

# Prompt and read string from stdin
ReadData() {
    echo -n $3 "[$2]: "
    read p
    [ $p ] && eval $1=$p
}

# Check version of the tools used in Makefiles
CheckTools() {
    grep_ver=`grep --version 2>&1 | head -1`
    sed_ver=`sed --version 2>&1 | head -1`
    awk_ver=`awk --version 2>&1 | head -1`
}

# Main
ReadData RADIOSPATH $RADIOSPATH "Source root directory"
ReadData INCLPATH $INCLPATH "RadiOS headers directory"
ReadData OBJPATH $OBJPATH "Object directory"
ReadData LIBPATH $LIBPATH "Library directory"
ReadData INSTALLPATH $INSTALLPATH "Install directory"

awk -v RADIOSPATH=$RADIOSPATH \
    -v INCLPATH=$INCLPATH \
    -v OBJPATH=$OBJPATH \
    -v LIBPATH=$LIBPATH \
    -v INSTALLPATH=$INSTALLPATH '
/@@RADIOSPATH@@/	{ print $1,$2,RADIOSPATH; next }
/@@INCLPATH@@/		{ print $1,$2,INCLPATH; next }
/@@OBJPATH@@/		{ print $1,$2,OBJPATH; next }
/@@LIBPATH@@/		{ print $1,$2,LIBPATH; next }
/@@INSTALLPATH@@/	{ print $1,$2,INSTALLPATH; next }
			{ print $0 }
' build/header.mk.in > build/header.mk

echo
echo "Configuration file has been generated. Now run 'gmake dep', then 'gmake'."
